(this["webpackJsonpreact-cms"]=this["webpackJsonpreact-cms"]||[]).push([[2],{148:function(e,t,a){"use strict";a(0),a(57)},230:function(e,t,a){e.exports=a(244)},235:function(e,t,a){},244:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(11),o=a.n(i),c=a(220),l=(a(210),a(235),a(13)),s=a(44),u=function(e){return r.a.createElement(s.a,{to:"/article"})},m=function(e){var t=e.routes.map((function(e,t){return e.routes&&e.routes.length?r.a.createElement(s.b,{path:e.path,key:e.path,render:function(t){return r.a.createElement(e.component,Object.assign({},t,{title:e.title,routes:e.routes}))}}):r.a.createElement(s.b,{path:e.path,key:e.path,component:e.component})}));return r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",component:u}),t)},d=function(e){return r.a.createElement(l.a,{store:e.store},r.a.createElement(s.c,{history:e.history},r.a.createElement(m,e)))},p=a(26),g=Object(p.a)();g.listen((function(e){console.log("history is listening: "+e)}));var h=g,f=a(136),b=a(73),v=(a(241),a(7)),y=a(303),E=a(304),x=a(305),O=a(306),j=a(3),A=a(278),I=a(57),w=a(286),S=a(287),k=a(137),D=a(291),C=a(19),T=a(20),R=a(21),N=a(22),L=a(25),F=a(16),B=a(285),H=a(288),W=a(289),z=a(290),P=a(52),_=a.n(P),q=(a(148),a(246)),M=a(260),J=a(309),U=a(247),V=a(279),G=a(282),Y=Object(A.a)((function(e){return{select:{width:"100%"}}})),X=function(e){var t=e.options,a=void 0===t?[]:t,n=e.value,i=e.className,o=e.changeHandler,c=void 0===o?function(e){}:o,l=e.multiple,s=void 0!==l&&l,u=e.itemType,m=void 0===u?"simple":u,d=r.a.useState(n||(s?[]:"")),p=Object(L.a)(d,2),g=p[0],h=p[1],f=Y(),b=r.a.useRef(null),v=r.a.useState(0),y=Object(L.a)(v,2),E=y[0],x=y[1];r.a.useEffect((function(){x(b.current.offsetWidth)}),[]);var O="";return"checkbox"===m&&(O=a.map((function(e,t){return r.a.createElement(V.a,{key:t,value:e._id},r.a.createElement(J.a,{checked:e.indexOf(e._id)>-1}),r.a.createElement(G.a,{primary:e.name}))}))),"simple"===m&&(O=a.map((function(e,t){return r.a.createElement(V.a,{key:t,value:e._id},e.name)}))),r.a.createElement(q.a,{variant:"outlined",margin:"normal",className:f.select+" "+i},r.a.createElement(U.a,{ref:b,id:"demo-simple-select-outlined-label"},"Category"),r.a.createElement(M.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",name:"category",value:g,onChange:function(e){console.log("changed",e.target.value),h(e.target.value),c(e.target.value)},labelWidth:E,multiple:s},O))},$=a(307),K=a(284),Q=a(211),Z=a.n(Q),ee=Object(A.a)((function(e){return{input:{width:"100%"},header:{marginBottom:e.spacing(3)},addButton:{marginTop:e.spacing(2)}}})),te=function(e){var t=e.defaultValue,a=void 0===t?"":t,n=e.handler,i=ee();return r.a.createElement(B.a,{variant:"outlined",id:"outlined-multiline-static",multiline:!0,rows:"8",defaultValue:a,className:i.input,onChange:n})},ae=function(e){var t=e.items,a=e.changeHandler,i=ee(),o=function(e){var t=[{content:e.target.value}];a(t)};return r.a.createElement(n.Fragment,null,r.a.createElement(I.a,{component:"h2",variant:"h4",className:i.header},"Main content"),t.map((function(e,t){return r.a.createElement(te,{handler:o,defaultValue:e.content})})),r.a.createElement($.a,{textAlign:"center"},r.a.createElement(K.a,{variant:"extended",color:"primary","aria-label":"add",size:"small",className:i.addButton},r.a.createElement(Z.a,null),"more paragraph")))},ne=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return{title:e,path:t,component:a,reducer:n,onEnter:i,children:r}},re=function(e){return Object.keys(e).map((function(t){var a=Array.isArray(e[t])?e[t]:[e[t]];return a.forEach((function(e){return e.MODULE=t})),a})).reduce((function(e,t){return e.concat(t)}))},ie=function(e){return function(t){return Object(l.b)(null,(function(e){return{setTitle:function(t){e({type:Bt,payload:t})}}}))((function(a){return a.setTitle(t),r.a.createElement(e,null)}))}},oe=Object(n.lazy)((function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,330))})),ce=function(e){Object(N.a)(a,e);var t=Object(R.a)(a);function a(e){return Object(C.a)(this,a),t.call(this,e)}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.items,a=e.loadItems;t&&t.length||a()}},{key:"render",value:function(){console.log("Category List",this.props);var e=this.props,t=e.match,a=e.items,i=(e.loadingItems,e.showDeleteDialog,e.onDelete),o=(e.deleteDialogOpen,e.deleteId,e.header);return r.a.createElement(n.Suspense,{fallback:"Loading..."},r.a.createElement(oe,{columnNames:["Name"],rows:a.map((function(e,t){return{_id:e._id,columns:[{text:e.name}]}})),path:t?t.path:"/admin/categories",header:o,onDelete:i,addItemText:"Add Category",searchBoxPlaceholder:"search category"}))}}]),a}(r.a.Component),le=ie(Object(l.b)((function(e){var t=e.Admin.Category;return Object(v.a)({},t)}),(function(e){return{loadItems:function(){return e({type:ge}),fetch("/api/category/get").then((function(e){return e.ok?e.json():[]})).then((function(t){e({type:he,payload:{items:t}})}))},onDelete:function(t){var a={id:t};return fetch("/api/category/delete",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():{}})).then((function(t){t.result&&"success"===t.result&&e({type:Ee,payload:{item:t.data}})}))}}}))(ce))("Categories"),se=Object(A.a)((function(e){return{container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},textField:{width:"100%"},themesSelect:{width:"100%"},button:{float:"right"}}}));function ue(e){var t=e.item,a=e.match,n=(e.themes,e.update),i=e.action,o=e.saving,c=se(),l=r.a.useState(""),u=Object(L.a)(l,2),m=u[0],d=u[1];return m?(console.log("redirecting",m),r.a.createElement(s.a,{to:m})):r.a.createElement(w.a,{maxWidth:"lg",className:c.container},r.a.createElement(S.a,{container:!0,spacing:3},r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(F.a,{to:"/admin/categories"},r.a.createElement(H.a,{variant:"contained",color:"primary"},r.a.createElement(_.a,null)," Back to list"))),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(k.a,{className:c.paper},r.a.createElement("form",{onSubmit:function(e){var t={name:e.target.elements.name.value};"edit"===i&&(t.id=a.params.itemId),n(t).then((function(e){"success"===e.result&&d("/admin/categories")})),e.preventDefault()}},r.a.createElement(S.a,{container:!0,spacing:3},r.a.createElement(S.a,{item:!0,sm:12},r.a.createElement(B.a,{id:"outlined-basic",className:c.textField,label:"Category name",margin:"normal",variant:"outlined",name:"name",defaultValue:t.name,required:!0})),r.a.createElement(S.a,{item:!0,sm:12},r.a.createElement(H.a,{type:"submit",variant:"contained",color:"primary",className:c.button,disabled:o},o?r.a.createElement(W.a,{size:"1rem"}):"Save"))))))))}var me=function(e){Object(N.a)(a,e);var t=Object(R.a)(a);function a(e){var n;return Object(C.a)(this,a),(n=t.call(this,e)).state={action:""},n}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.loadItem,a=e.match,n=e.setTitle;a.params.itemId?(this.setState({action:"edit"}),n("Edit category"),t(a.params.itemId)):(this.setState({action:"add"}),n("Add category"))}},{key:"render",value:function(){console.log("Edit Request",this.props);var e=this.props,t=e.match,a=e.item,n=e.themes,i=e.update,o=e.loadingItem,c=e.saving,l=this.state.action;return o?r.a.createElement(z.a,null):r.a.createElement(ue,{action:l,item:"edit"==l?a:{},match:t,themes:n,update:i,saving:c})}}]),a}(r.a.Component),de=Object(l.b)((function(e){var t=e.Admin.Category;return{items:t.items,item:t.item,loadingItem:t.loadingItem,saving:t.saving}}),(function(e){return{loadItem:function(t){return e({type:fe}),fetch("/api/category/get?id="+t).then((function(e){return e.ok?e.json():{}})).then((function(t){e({type:be,payload:{item:t}})}))},setTitle:function(t){e({type:Bt,payload:t})},update:function(t){return e({type:ve}),fetch("/api/category/store",{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():{}})).then((function(t){return e({type:ye,payload:{item:t.data,result:t.result}}),t}))}}}))(me),pe="Admin/Category/",ge=pe+"LoadItemsReq",he=pe+"LoadItemsRes",fe=pe+"LoadItemReq",be=pe+"LoadItemRes",ve=pe+"SaveReq",ye=pe+"SaveRes",Ee=pe+"DeleteRes",xe={items:[],loadingItems:!1,item:{},loadingItem:!1,deleteDialogOpen:!1,deleteId:"",saving:!1},Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fe:return Object(v.a)({},e,{loadingItem:!0});case be:var a=t.payload.item;return Object(v.a)({},e,{item:a,loadingItem:!1});case ge:return Object(v.a)({},e,{loadingItems:!0});case he:return Object(v.a)({},e,{loadingItems:!1,items:t.payload.items});case ve:return Object(v.a)({},e,{saving:!0});case ye:a=t.payload.item;var n=!1,r=e.items.map((function(e,t){return e&&e._id===a._id?(n=!0,a):e}));return n||r.push(a),Object(v.a)({},e,{items:r,saving:!1});case"Admin/Category/ShowDeleteDialog":return Object(v.a)({},e,{deleteDialogOpen:!0,deleteId:t.payload.deleteId});case"Admin/Category/CloseDeleteDialog":return Object(v.a)({},e,{deleteDialogOpen:!1});case Ee:a=t.payload.item;return Object(v.a)({},e,{items:e.items.filter((function(e){return e._id!==a._id}))});default:return e}},je=ne("Categories","/categories",(function(e){return r.a.createElement("div",null,r.a.createElement(s.b,{exact:!0,path:e.match.path,component:le}),r.a.createElement(s.b,{exact:!0,path:e.match.path+"/edit/:itemId",component:de}),r.a.createElement(s.b,{exact:!0,path:e.match.path+"/add",component:de}))}),Oe),Ae=Object(A.a)((function(e){return{container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},textField:{width:"100%"},button:{float:"right"}}}));function Ie(e){var t=e.item,a=e.match,n=e.categories,i=void 0===n?[]:n,o=e.update,c=e.action,l=e.saving,u=Ae(),m=r.a.useState(""),d=Object(L.a)(m,2),p=d[0],g=d[1],h=r.a.useState(t.title),f=Object(L.a)(h,2),b=f[0],v=f[1],y=r.a.useState(t.category||[]),E=Object(L.a)(y,2),x=E[0],O=E[1],j=r.a.useState(t.subtitle||""),A=Object(L.a)(j,2),I=A[0],D=A[1],C=r.a.useState(t.paragraphs||[{content:""}]),T=Object(L.a)(C,2),R=T[0],N=T[1],z=r.a.useState(null),P=Object(L.a)(z,2),q=P[0],M=P[1];return p?(console.log("redirecting",p),r.a.createElement(s.a,{to:p})):r.a.createElement(w.a,{maxWidth:"lg",className:u.container},r.a.createElement(S.a,{container:!0,spacing:3},r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(F.a,{to:"/admin/products"},r.a.createElement(H.a,{variant:"contained",color:"primary"},r.a.createElement(_.a,null)," Back to list"))),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(k.a,{className:u.paper},r.a.createElement("form",{onSubmit:function(e){e.target.elements;var t=new FormData;t.append("title",b),t.append("subtitle",I),t.append("category",JSON.stringify(x)),t.append("paragraphs",JSON.stringify(R)),t.append("image",q),"edit"===c&&t.append("id",a.params.itemId),o(t).then((function(e){e.result,function(e,t){if(!t)return{result:"success",message:"no need for uploading to cloud"};var a=new FormData;return a.append("app","medium"),a.append("filename",t),a.append("file",e),fetch("https://cloud.javelin.uz/file-upload.php",{method:"POST",body:a,headers:{Accept:"application/json"}}).then((function(e){return e.ok?e.json():{result:"error",message:"request to cloud failed"}})).catch((function(e){return console.error("Error on file uploading: ",e),{result:"error",message:"Error on file uploading: "+e}}))}(q,e.filename).then((function(e){e.result,g("/admin/articles")}))})),e.preventDefault()}},r.a.createElement(S.a,{container:!0,spacing:3},r.a.createElement(S.a,{item:!0,sm:6},r.a.createElement(B.a,{id:"outlined-basic",className:u.textField,label:"Title",margin:"normal",variant:"outlined",name:"title",defaultValue:b,required:!0,onChange:function(e){v(e.target.value)}})),r.a.createElement(S.a,{item:!0,sm:6},r.a.createElement(X,{options:i,value:x.map((function(e,t){return e._id})),className:u.selectCategory,multiple:!0,changeHandler:function(e){return O(e)}})),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(Se,{image:t.image}),r.a.createElement(H.a,{variant:"contained",component:"label"},"Upload image",r.a.createElement("input",{type:"file",style:{display:"none"},onChange:function(e){M(e.target.files[0])}}))),r.a.createElement(S.a,{item:!0,sm:12},r.a.createElement(B.a,{variant:"outlined",id:"outlined-multiline-static",label:"Subtitle",multiline:!0,rows:"2",defaultValue:I,className:u.textField,onChange:function(e){D(e.target.value)}})),r.a.createElement(S.a,{item:!0,sm:12},r.a.createElement(ae,{items:R,changeHandler:function(e){return N(e)}})),r.a.createElement(S.a,{item:!0,sm:12},r.a.createElement(H.a,{type:"submit",variant:"contained",color:"primary",className:u.button,disabled:l},l?r.a.createElement(W.a,{size:"1rem"}):"Save"))))))))}var we=function(e){Object(N.a)(a,e);var t=Object(R.a)(a);function a(e){var n;return Object(C.a)(this,a),(n=t.call(this,e)).state={action:n.props.match.params.itemId?"edit":"add"},n}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.loadItem,a=e.match,n=e.setTitle,r=e.loadCategories,i=e.categories;a.params.itemId?(n("Edit article"),t(a.params.itemId)):n("Add article"),i.length||r()}},{key:"render",value:function(){console.log("Edit item",this.props);var e=this.props,t=e.match,a=e.item,n=e.update,i=e.loadingItem,o=e.saving,c=e.categories,l=this.state.action;return i?r.a.createElement(z.a,null):r.a.createElement(Ie,{action:l,item:"edit"===l?a:{},match:t,categories:c,update:n,saving:o})}}]),a}(r.a.Component),Se=function(e){var t=e.image;return t?r.a.createElement("img",{src:t.url,width:"300px"}):""},ke=Object(l.b)((function(e){var t=e.Admin.Article,a=e.Admin.Category;return{items:t.items,item:t.item,loadingItem:t.loadingItem,saving:t.saving,categories:a.items}}),(function(e){return{loadItem:function(t){return e({type:De}),fetch("/api/article/get?id="+t).then((function(e){return e.ok?e.json():{}})).then((function(t){e({type:Ce,payload:{item:t}})}))},setTitle:function(t){e({type:Bt,payload:t})},update:function(t){return e({type:Te}),fetch("/api/article/store",{method:"POST",body:t}).then((function(e){return e.ok?e.json():{}})).then((function(t){return e({type:Re,payload:{item:t.data,result:t.result}}),t}))},loadCategories:function(){return e({type:ge}),fetch("/api/category/get").then((function(e){return e.ok?e.json():[]})).then((function(t){e({type:he,payload:{items:t}})}))}}}))(we),De="Admin/Article/LoadItemReq",Ce="Admin/Article/LoadItemRes",Te="Admin/Article/SaveReq",Re="Admin/Article/SaveRes",Ne={items:[],loadingItems:!1,shouldLoadItems:!0,item:{},loadingItem:!1,deleteDialogOpen:!1,deleteId:"",saving:!1},Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case De:return Object(v.a)({},e,{loadingItem:!0});case Ce:var a=t.payload.item;return Object(v.a)({},e,{item:a,loadingItem:!1});case"Admin/Article/LoadItemsReq":return Object(v.a)({},e,{loadingItems:!0});case"Admin/Article/LoadItemsRes":return Object(v.a)({},e,{loadingItems:!1,shouldLoadItems:!1,items:t.payload.items});case Te:return Object(v.a)({},e,{saving:!0});case Re:a=t.payload.item;var n=!1,r=e.items.map((function(e,t){return e&&e._id===a._id?(n=!0,a):e}));return n||r.push(a),Object(v.a)({},e,{items:r,saving:!1});case"Admin/Article/ShowDeleteDialog":return Object(v.a)({},e,{deleteDialogOpen:!0,deleteId:t.payload.deleteId});case"Admin/Article/CloseDeleteDialog":return Object(v.a)({},e,{deleteDialogOpen:!1});case"Admin/Article/DeleteRes":a=t.payload.item;return Object(v.a)({},e,{items:e.items.filter((function(e){return e._id!==a._id}))});default:return e}},Fe=ne("Articles","/articles",(function(e){return r.a.createElement("div",null,r.a.createElement(s.b,{exact:!0,path:e.match.path,component:ze}),r.a.createElement(s.b,{exact:!0,path:e.match.path+"/edit/:itemId",component:ke}),r.a.createElement(s.b,{exact:!0,path:e.match.path+"/add",component:ke}))}),Le),Be=Object(n.lazy)((function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,330))})),He=function(e){Object(N.a)(a,e);var t=Object(R.a)(a);function a(e){return Object(C.a)(this,a),t.call(this,e)}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=(e.items,e.loadItems);e.shouldLoadItems&&t()}},{key:"render",value:function(){console.log("Articles List",this.props);var e=this.props,t=e.match,a=e.items,i=e.loadingItems,o=(e.showDeleteDialog,e.onDelete);e.deleteDialogOpen,e.deleteId,e.header;return r.a.createElement(n.Suspense,{fallback:"Loading..."},r.a.createElement(Be,{loading:i,columnNames:["Title","Subtitle","Category","Author"],rows:a.map((function(e,t){return{_id:e._id,columns:[{text:e.title},{text:e.subtitle},{text:e.category.map((function(e,t){return e.name})).join(",")},{text:"Blogger"}]}})),path:t?t.path:"/admin/articles",onDelete:o,addItemText:"Add Article"}))}}]),a}(r.a.Component),We=Object(l.b)((function(e){var t=e.Admin.Article;return Object(v.a)({},t)}),(function(e){return{loadItems:function(){return e({type:"Admin/Article/LoadItemsReq"}),fetch("/api/article/get").then((function(t){return t.ok?t.json():(e({type:Wt,payload:{type:"error",text:"Connection with server failed..."}}),[])})).then((function(t){e({type:"Admin/Article/LoadItemsRes",payload:{items:t}})}))},onDelete:function(t){var a={id:t};return fetch("/api/article/delete",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():{}})).then((function(t){t.result&&"success"===t.result&&e({type:"Admin/Article/DeleteRes",payload:{item:t.data}})}))}}}))(He),ze=ie(We)("Articles");var Pe=Object(A.a)((function(e){return{container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"}}})),_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"DEFAULT"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"Dashboard/FirstAction":return{name:"Javlonbek"};default:return e}},qe=ne("Dashboard","/",(function(e){var t=Pe();Object(j.a)(t.paper,t.fixedHeight);return console.log("Dashboard",e),r.a.createElement(r.a.Fragment,null,r.a.createElement(We,{header:"Articles"}),r.a.createElement(w.a,{maxWidth:"lg",className:t.container},r.a.createElement(S.a,{container:!0,spacing:3},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(k.a,{className:t.paper},"Some Dashboard Content")))))}),_e),Me=a(302),Je=a(308),Ue=a(292),Ve=Object(A.a)((function(e){return{collapse:{position:"absolute",top:"0.8rem",right:"0.8rem",zIndex:9999}}})),Ge=Object(l.b)((function(e){return Object(v.a)({},e.Admin.alert)}),(function(e){return{close:function(){e({type:zt})}}}))((function(e){var t=e.type,a=e.text,n=e.close,i=e.open,o=Ve();return console.log("alert rendering",i),t?(setTimeout((function(){return n()}),5e3),r.a.createElement(Ue.a,{in:i,className:o.collapse},r.a.createElement(Je.a,{severity:t,onClose:function(){return n()}},a.toString()))):null})),Ye=a(63),Xe=a(294),$e=a(299),Ke=a(295),Qe=a(296),Ze=a(254),et=a(300),tt=a(281),at=a(297),nt=a(131),rt=a.n(nt),it=a(132),ot=a.n(it),ct=a(245),lt=a(293),st=a(298);function ut(){return r.a.createElement(I.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(F.a,{color:"inherit",to:"/"},"RJ")," ",(new Date).getFullYear(),".")}var mt=Object(A.a)((function(e){return{root:{display:"flex"},toolbar:{paddingRight:24},toolbarIcon:Object(v.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(Ye.a)({overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7)},e.breakpoints.up("sm"),{width:e.spacing(9)}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:240}}})),dt=function(e){var t=e.items,a=e.accessRights;return t=t.map((function(e,t){if(a&&a.length&&a.indexOf(e.accessRightTitle)>=0||!e.accessRightTitle){var n=e.icon;return r.a.createElement(ct.a,{button:!0,key:t},r.a.createElement(lt.a,null,r.a.createElement(n,null)),r.a.createElement(F.a,{to:e.link},r.a.createElement(G.a,{primary:e.text})))}})),r.a.createElement("div",null,t)};var pt=Object(l.b)((function(e){return{title:e.Admin.title,menuItems:e.Admin.menuItems,rights:e.Admin.user.rights,user:e.Admin.user}}),(function(e){return{logOut:function(){return e({type:Ht}),fetch("/api/user/logout").then((function(e){return console.log("logged out"),""}))}}}))((function(e){console.log("Layout",e);var t=mt(),a=r.a.useState(!0),n=Object(L.a)(a,2),i=n[0],o=n[1];return Object(j.a)(t.paper,t.fixedHeight),r.a.createElement("div",{className:t.root},r.a.createElement(Xe.a,null),r.a.createElement(Ke.a,{position:"absolute",className:Object(j.a)(t.appBar,i&&t.appBarShift)},r.a.createElement(Qe.a,{className:t.toolbar},r.a.createElement(tt.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(){o(!0)},className:Object(j.a)(t.menuButton,i&&t.menuButtonHidden)},r.a.createElement(rt.a,null)),r.a.createElement(I.a,{component:"h1",variant:"h4",color:"inherit",noWrap:!0,className:t.title},e.title),r.a.createElement(tt.a,{color:"inherit"},r.a.createElement(at.a,{badgeContent:0,color:"secondary"},r.a.createElement(ot.a,null))),r.a.createElement(tt.a,{color:"inherit",title:"Log out",onClick:function(t){e.logOut().then((function(){e.history.goBack()}))}},r.a.createElement(st.a,null)))),r.a.createElement($e.a,{variant:"permanent",classes:{paper:Object(j.a)(t.drawerPaper,!i&&t.drawerPaperClose)},open:i},r.a.createElement("div",{className:t.toolbarIcon},r.a.createElement(tt.a,{onClick:function(){o(!1)}},r.a.createElement(_.a,null))),r.a.createElement(et.a,null),r.a.createElement(Ze.a,null,r.a.createElement(dt,{items:e.menuItems,accessRights:e.rights}))),r.a.createElement("main",{className:t.content},r.a.createElement("div",{className:t.appBarSpacer}),e.children,r.a.createElement(ut,null)))})),gt=a(310),ht=a(301),ft=a(219),bt=a.n(ft);function vt(){return r.a.createElement(I.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(D.a,{color:"inherit",href:"https://material-ui.com/"},"RJ")," ",(new Date).getFullYear(),".")}var yt=Object(A.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),Et=function(e){Object(N.a)(a,e);var t=Object(R.a)(a);function a(e){var n;return Object(C.a)(this,a),(n=t.call(this,e)).changeHandler=function(e,t){n.setState(Object(Ye.a)({},e,t))},n.submitHandler=function(){(0,n.props.signIn)(n.state.email,n.state.password)},n.state={email:"",password:""},n}return Object(T.a)(a,[{key:"render",value:function(){var e=this.props,t=(e.signIn,e.user),a=(e.match,this.state);a.email,a.password;if(console.log("Login",this.props),t&&t.loggedIn){var n=window.localStorage.getItem("lastVisitedPath");return r.a.createElement(s.a,{to:n||"/admin"})}return r.a.createElement(w.a,{component:"main",maxWidth:"xs"},r.a.createElement(Xe.a,null),r.a.createElement(xt,{changeHandler:this.changeHandler,submitHandler:this.submitHandler,failed:t.loginAttempted,authenticating:t.authenticating}),r.a.createElement(Ge,null),r.a.createElement($.a,{mt:8},r.a.createElement(vt,null)))}}]),a}(r.a.Component),xt=function(e){var t=e.changeHandler,a=e.submitHandler,n=e.failed,i=e.authenticating,o=yt();return r.a.createElement("div",{className:o.paper},r.a.createElement(gt.a,{className:o.avatar},r.a.createElement(bt.a,null)),r.a.createElement(I.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:o.form,onSubmit:function(e){e.preventDefault(),a()}},r.a.createElement(B.a,{error:n,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"username",autoComplete:"off",autoFocus:!0,onChange:function(e){return t("email",e.target.value)}}),r.a.createElement(B.a,{error:n,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"off",onChange:function(e){return t("password",e.target.value)}}),r.a.createElement(ht.a,{control:r.a.createElement(J.a,{value:"remember",color:"primary"}),label:"Remember me"}),r.a.createElement(H.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:o.submit,disabled:i},i?r.a.createElement(W.a,null):"Sign In"),r.a.createElement(S.a,{container:!0},r.a.createElement(S.a,{item:!0,xs:!0},r.a.createElement(D.a,{href:"#",variant:"body2"},"Forgot password?")),r.a.createElement(S.a,{item:!0},r.a.createElement(D.a,{href:"#",variant:"body2"},"Don't have an account? Sign Up")))))},Ot=Object(l.b)((function(e){return{user:e.Admin.user}}),(function(e){return{signIn:function(t,a){return e({type:Lt}),fetch("/admin/login",{method:"POST",body:JSON.stringify({username:t,password:a}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e({type:Ft,payload:Object(v.a)({},t.user,{loginAttempted:!0})}),t.result})).catch((function(t){e({type:Ft,payload:{}}),e({type:Wt,payload:{type:"error",text:"Connection with server failed..."}})}))},alert:function(t){e({type:Wt,payload:t})}}}))(Et),jt=a(221),At=a(8),It="#FFFFFF",wt={black:"#000000",white:It,primary:{contrastText:It,dark:At.a.indigo[900],main:At.a.indigo[500],light:At.a.indigo[100]},secondary:{contrastText:It,dark:At.a.blue[900],main:At.a.blue.A400,light:At.a.blue.A400},success:{contrastText:It,dark:At.a.green[900],main:At.a.green[600],light:At.a.green[400]},info:{contrastText:It,dark:At.a.blue[900],main:At.a.blue[600],light:At.a.blue[400]},warning:{contrastText:It,dark:At.a.orange[900],main:At.a.orange[600],light:At.a.orange[400]},error:{contrastText:It,dark:At.a.red[900],main:At.a.red[600],light:At.a.red[400]},text:{primary:At.a.blueGrey[900],secondary:At.a.blueGrey[600],link:At.a.blue[600]},background:{default:"#F4F6F8",paper:It},icon:At.a.blueGrey[600],divider:At.a.grey[200]},St={h1:{color:wt.text.primary,fontWeight:500,fontSize:"35px",letterSpacing:"-0.24px",lineHeight:"40px"},h2:{color:wt.text.primary,fontWeight:500,fontSize:"29px",letterSpacing:"-0.24px",lineHeight:"32px"},h3:{color:wt.text.primary,fontWeight:500,fontSize:"24px",letterSpacing:"-0.06px",lineHeight:"28px"},h4:{color:wt.text.primary,fontWeight:500,fontSize:"20px",letterSpacing:"-0.06px",lineHeight:"24px"},h5:{color:wt.text.primary,fontWeight:500,fontSize:"16px",letterSpacing:"-0.05px",lineHeight:"20px"},h6:{color:wt.text.primary,fontWeight:500,fontSize:"14px",letterSpacing:"-0.05px",lineHeight:"20px"},subtitle1:{color:wt.text.primary,fontSize:"16px",letterSpacing:"-0.05px",lineHeight:"25px"},subtitle2:{color:wt.text.secondary,fontWeight:400,fontSize:"14px",letterSpacing:"-0.05px",lineHeight:"21px"},body1:{color:wt.text.primary,fontSize:"15px",letterSpacing:"-0.05px",lineHeight:"21px"},body2:{color:wt.text.secondary,fontSize:"13px",letterSpacing:"-0.04px",lineHeight:"18px"},button:{color:wt.text.primary,fontSize:"14px"},caption:{color:wt.text.secondary,fontSize:"11px",letterSpacing:"0.33px",lineHeight:"13px"},overline:{color:wt.text.secondary,fontSize:"11px",fontWeight:500,letterSpacing:"0.33px",lineHeight:"13px",textTransform:"uppercase"}},kt={MuiButton:{contained:{boxShadow:"0 1px 1px 0 rgba(0,0,0,0.14), 0 2px 1px -1px rgba(0,0,0,0.12), 0 1px 3px 0 rgba(0,0,0,0.20)",backgroundColor:"#FFFFFF"}},MuiIconButton:{root:{color:wt.icon,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.03)"}}},MuiPaper:{elevation1:{boxShadow:"0 0 0 1px rgba(63,63,68,0.05), 0 1px 3px 0 rgba(63,63,68,0.15)"}},MuiTableCell:{root:Object(v.a)({},St.body1,{borderBottom:"1px solid ".concat(wt.divider)})},MuiTableHead:{root:{backgroundColor:At.a.grey[50]}},MuiTypography:{gutterBottom:{marginBottom:8}}},Dt=Object(jt.a)({palette:wt,typography:St,overrides:kt,zIndex:{appBar:1200,drawer:1100}});function Ct(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],function(a){Object(N.a)(i,a);var n=Object(R.a)(i);function i(e){var t;return Object(C.a)(this,i),(t=n.call(this,e)).getUser=function(){return new Promise((function(e,a){t.props.user&&t.props.user.loggedIn?e(t.props.user):t.props.getActiveUser().then((function(t){e(t)}))}))},t.state={redirect:!1,loading:!0,hasAccessRight:!0},t}return Object(T.a)(i,[{key:"componentDidMount",value:function(){var e=this;this.getUser().then((function(a){var n=!0,r=!1;a&&a._id?!t||a.rights.indexOf(t)>=0||(n=!1):r=!0,e.setState({redirect:r,loading:!1,hasAccessRight:n})}))}},{key:"render",value:function(){console.log("withAuth",t);var a=this.state,n=a.redirect,i=a.loading,o=a.hasAccessRight,c=this.props;return c.location.pathname===c.match.path+"/login"?r.a.createElement(Me.a,{theme:Dt},r.a.createElement(Ot,null)):i?r.a.createElement(z.a,null):(o||(console.log("has no access right",c.user.rights),c.history.goBack()),!c.user.loggedIn&&n?(window.localStorage.setItem("lastVisitedPath",this.props.location.pathname),console.log("redirecting",c.match.path+"/login"),r.a.createElement(s.a,{to:"/admin/login"})):r.a.createElement(r.a.Fragment,null,r.a.createElement(e,this.props)))}}]),i}(n.Component)),i=function(e){return{user:e.Admin.user}},o=function(e){return{getActiveUser:function(){return e({type:Lt}),fetch("/user/active").then((function(e){return e.json()})).then((function(t){return e({type:Ft,payload:t.user}),t.user})).catch((function(t){return e({type:Ft,payload:{}}),console.error(t),e({type:Wt,payload:{type:"error",text:"Connection with server failed..."}}),{}}))}}};return Object(l.b)(i,o)(a)}var Tt=function(e){Object(N.a)(a,e);var t=Object(R.a)(a);function a(){return Object(C.a)(this,a),t.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var e=this.props;return r.a.createElement(Me.a,{theme:Dt},r.a.createElement(Ge,null),r.a.createElement(pt,e,r.a.createElement(Rt,{routes:e.routes,match:e.match})))}}]),a}(r.a.Component),Rt=function(e){var t=e.routes,a=e.match;return t.map((function(e,t){return r.a.createElement(s.b,{exact:e.path===a.path+"/",path:e.path,key:e.path,component:Ct(e.component,e.title),title:e.title})}))},Nt=Ct(Tt),Lt="Admin/SignInReq",Ft="Admin/SignInRes",Bt="Admin/SetTitle",Ht="Admin/LogOut",Wt="Admin/Alert",zt="Admin/AlertClose",Pt={title:"Dashboard",menuItems:[{text:"Dashboard",accessRightTitle:"Dashboard",link:"/admin",icon:y.a},{text:"Authors",accessRightTitle:"Employees",link:"/admin/authors",icon:E.a},{text:"Articles",accessRightTitle:"Articles",link:"/admin/articles",icon:x.a},{text:"Categories",accessRightTitle:"Categories",link:"/admin/categories",icon:O.a}]},_t={loggedIn:!1,authenticating:!1,loginAttempted:!1},qt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_t,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Lt:return Object(v.a)({},e,{authenticating:!0});case Ft:var a=t.payload;return a&&a.username?Object(v.a)({},e,{},t.payload,{loggedIn:!0,authenticating:!1}):Object(v.a)({},e,{},t.payload,{loginFailed:!0,authenticating:!1,loggedIn:!1});case Ht:return Pt;default:return e}},Mt={type:"",text:"asd",open:!0},Jt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Wt:return Object(v.a)({},e,{},t.payload,{open:!0});case zt:return{open:!1,type:""};default:return e}},Ut=ne("Admin","/admin",Nt,(function(){var e,t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,n=arguments.length>1?arguments[1]:void 0;return Object(v.a)({},Pt,{Dashboard:_e(a.Dashboard,n),Category:Oe(a.Category,n),Article:Le(a.Article,n),user:qt(a.user,n),alert:Jt(a.alert,n),title:(e=a.title,t=n,t.type===Bt?t.payload:e)})}),{Dashboard:qe,Category:je,Article:Fe}),Vt=function(e){Object(N.a)(a,e);var t=Object(R.a)(a);function a(e){return Object(C.a)(this,a),t.call(this,e)}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=(e.items,e.loadItems);e.shouldLoadItems&&t()}},{key:"render",value:function(){console.log("Articles List",this.props);var e=this.props;e.match,e.items,e.loadingItems,e.showDeleteDialog,e.onDelete,e.deleteDialogOpen,e.deleteId,e.header;return r.a.createElement("div",{className:"m-4"},"Main PAge")}}]),a}(r.a.Component),Gt=Object(l.b)((function(e){var t=e.Admin.Article;return Object(v.a)({},t)}),(function(e){return{loadItems:function(){return e({type:Yt}),fetch("/api/article/get").then((function(e){return e.ok?e.json():[]})).then((function(t){e({type:Xt,payload:{items:t}})}))},onDelete:function(t){var a={id:t};return fetch("/api/article/delete",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():{}})).then((function(t){t.result&&"success"===t.result&&e({type:$t,payload:{item:t.data}})}))}}}))(Vt),Yt="Article/LoadItemsReq",Xt="Article/LoadItemsRes",$t="Article/DeleteRes",Kt={items:[],loadingItems:!1,shouldLoadItems:!0,item:{},loadingItem:!1,deleteDialogOpen:!1,deleteId:"",saving:!1},Qt={Admin:Ut,Article:ne("Article","/article",(function(e){return r.a.createElement("div",null,r.a.createElement(s.b,{exact:!0,path:e.match.path,component:Gt}),r.a.createElement(s.b,{exact:!0,path:e.match.path+"/:slug",component:Gt}))}),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"Article/LoadItemReq":return Object(v.a)({},e,{loadingItem:!0});case"Article/LoadItemRes":var a=t.payload.item;return Object(v.a)({},e,{item:a,loadingItem:!1});case Yt:return Object(v.a)({},e,{loadingItems:!0});case Xt:return Object(v.a)({},e,{loadingItems:!1,shouldLoadItems:!1,items:t.payload.items});case"Article/SaveReq":return Object(v.a)({},e,{saving:!0});case"Article/SaveRes":a=t.payload.item;var n=!1,r=e.items.map((function(e,t){return e&&e._id===a._id?(n=!0,a):e}));return n||r.push(a),Object(v.a)({},e,{items:r,saving:!1});case"Article/ShowDeleteDialog":return Object(v.a)({},e,{deleteDialogOpen:!0,deleteId:t.payload.deleteId});case"Article/CloseDeleteDialog":return Object(v.a)({},e,{deleteDialogOpen:!1});case $t:a=t.payload.item;return Object(v.a)({},e,{items:e.items.filter((function(e){return e._id!==a._id}))});default:return e}}))},Zt=function(e){var t=[];return t=Object(f.a)(t),Object(b.d)(e,b.a.apply(void 0,Object(f.a)(t)))}(Object(b.c)(function(e){for(var t={},a=re(e),n=0;n<a.length;n++){var r=a[n].reducer;if("function"!==typeof r)throw new Error("Module "+n+" does not define reducer!");t[a[n].MODULE]=r}return t}(Qt))),ea=function(e,t,a,n){arguments.length>4&&void 0!==arguments[4]&&arguments[4];return re(e).map((function(e){if(console.log("x",e),!e.component)throw new Error("Component for module "+e+" is not defined");var a={path:e.path,title:e.title,component:e.component,onEnter:e.onEnter?function(a){e.onEnter(a,t.dispatch)}:null};return e.children&&(a.routes=Object.keys(e.children).map((function(a){var n=e.children[a];if(!n.component)throw new Error("Component for module "+e+"/"+a+" is not defined");return{path:e.path+n.path,title:n.title,component:n.component,onEnter:n.onEnter?function(e){n.onEnter(e,t.dispatch)}:null}}))),a}))}(Qt,Zt,m,u),ta=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function aa(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(c.AppContainer,null,r.a.createElement(d,{store:Zt,history:h,routes:ea})),document.getElementById("root")),function(e){if(console.log("env","production"),"serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ta?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):aa(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):aa(t,e)}))}}()}},[[230,3,4]]]);
//# sourceMappingURL=main.d43fae8a.chunk.js.map